<?xml version="1.0" encoding="utf-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2003/01/wi">
  <Product Name="PHP 5.2.0" Id="A062A356-1B4E-4367-8E5B-26363021051B" 
    UpgradeCode="F0181ED2-F259-469F-B3C4-F74B5FDE951F" 
    Language="1033" 
    Codepage="1252" 
    Version="5.2.0" 
    Manufacturer="The PHP Group">

    <Package Id="????????-????-????-????-????????????" 
      Keywords="Installer" 
      Description="PHP Installer" 
      Comments="PHP" 
      Manufacturer="The PHP Group" 
      InstallerVersion="100" 
      Languages="1033" 
      Compressed="yes" 
      SummaryCodepage="1252"
      InstallPrivileges="elevated" />
  
    <Upgrade Id="F0181ED2-F259-469F-B3C4-F74B5FDE951F">
      <UpgradeVersion Property='OLDVERSION'
        MigrateFeatures="yes" 
        IncludeMinimum='yes' 
        Minimum='5.2.0' />
    </Upgrade>

    <Upgrade Id="91C7AD14-5A1B-4EB5-98B6-C0A9E4918CA9">
      <UpgradeVersion OnlyDetect="yes" Property="NONSXSVERSION" IncludeMaximum="no" IncludeMinimum="yes" Minimum="5.2.0" />
    </Upgrade>

    <Upgrade Id="ECF7FF5B-C55D-483B-88DE-51C5999DBE45">
      <UpgradeVersion OnlyDetect="yes" Property="SXSVERSION53" IncludeMaximum="no" IncludeMinimum="yes" Minimum="5.3.0" />
    </Upgrade>

    <Upgrade Id="B4C33633-5C4B-4306-9562-D0906DC354A3">
      <UpgradeVersion OnlyDetect="yes" Property="SXSVERSION60" IncludeMaximum="no" IncludeMinimum="yes" Minimum="6.0.0" />
    </Upgrade>

    <Condition 
      Message="You need to be an administrator to install PHP using this installer.">
      <![CDATA[Privileged OR (AdminUser AND VersionNT >= 600)]]>
    </Condition>
    
    <Condition 
      Message="PHP requires Windows NT/2000/XP/2003/Vista/2008 or later to install">
      <![CDATA[( VersionNT < 400 ) OR ( Version9x <> 0 )]]>
    </Condition>

    <Media Id="1" 
      Cabinet="PHP.cab" 
      EmbedCab="yes" 
      DiskPrompt="CD-ROM #1"/>
      
    <Property Id="DiskPrompt" Value="PHP Installer"/>
    
    <Property Id="ALLUSERS">1</Property>

    <Property Id="PHPINIEXISTS">
      <DirectorySearch Id="CheckFileDir" 
        Path="[INSTALLDIR]" 
        Depth="0">
        <FileSearch Id="CheckFile" Name="php.ini"/>
      </DirectorySearch>
    </Property>
    
    <Property Id="FASTCGI60MODULEINSTALLED">
      <DirectorySearch Id="InetsrvDir"
        Path="[WindowsFolder]system32\inetsrv"
        Depth="0">
        <FileSearch 
          Id="FcgiExtFile"
          Name="fcgiext.dll"/>
      </DirectorySearch>
    </Property>
    <Property Id="FASTCGI70MODULEINSTALLED">
      <RegistrySearch 
        Id="fastcgi70Registry" 
        Root="HKLM" 
        Key="SOFTWARE\Microsoft\InetStp\Components" 
        Type="raw"
        Name="FastCgi"
        Win64="yes"/>
    </Property>

    <Property Id="PHP53WEBSERVERTYPE">
      <RegistrySearch
        Id="php53servertyperegistry"
        Root="HKLM"
        Key="Software\PHP53"
        Type="raw"
        Name="WebServerType" />
    </Property>

    <Property Id="PHP60WEBSERVERTYPE">
      <RegistrySearch
        Id="php60servertyperegistry"
        Root="HKLM"
        Key="Software\PHP60"
        Type="raw"
        Name="WebServerType" />
    </Property>

    <Property Id="PHP53INSTALLDIR">
      <RegistrySearch
        Id="php53installregistry"
        Root="HKLM"
        Key="Software\PHP53"
        Type="raw"
        Name="InstallDir" />
    </Property>

    <Property Id="PHP60INSTALLDIR">
      <RegistrySearch
        Id="php60installregistry"
        Root="HKLM"
        Key="Software\PHP60"
        Type="raw"
        Name="InstalLDir" />
    </Property>

    <CustomAction Id='CheckFASTCGIINSTALLED' Property='FASTCGIINSTALLED' Value='1' />
    <CustomAction Id='CheckFASTCGINOTINSTALLED' Property='FASTCGIINSTALLED' Value='0' />
    <InstallUISequence>
      <Custom Action="CheckFASTCGIINSTALLED" After="CostInitialize">
        <![CDATA[FASTCGI60MODULEINSTALLED OR FASTCGI70MODULEINSTALLED]]>
      </Custom>
      <Custom Action="CheckFASTCGINOTINSTALLED" After="CostInitialize">
        <![CDATA[NOT FASTCGI60MODULEINSTALLED AND NOT FASTCGI70MODULEINSTALLED]]>
      </Custom>
    </InstallUISequence>
    
    <Property Id="APACHEREGDIR">
      <RegistrySearch Id="apacheRegistry" 
        Root="HKLM" 
        Key="Software\PHP52" 
        Type="raw" 
        Name="ApacheDir"
        Win64="yes"/>
    </Property>

    <CustomAction Id='AssignAPACHEDIR' Property='APACHEDIR' Value='[%ProgramFiles]' />
    <CustomAction Id='AssignAPACHEDIR2' Property='APACHEDIR' Value='[APACHEREGDIR]' />
    <InstallUISequence>
        <Custom Action="AssignAPACHEDIR" After="CostInitialize">NOT APACHEDIR</Custom>
        <Custom Action="AssignAPACHEDIR2" After="CostInitialize">APACHEREGDIR</Custom>
    </InstallUISequence>
    
    <Property Id="WEBSERVERPICKER">
      <RegistrySearch Id="webservertype" 
        Root="HKLM" 
        Key="Software\PHP52" 
        Type="raw" 
        Name="WebServerType"
        Win64="yes"/>
    </Property>
    
    <Directory Id="TARGETDIR" Name="SourceDir">
      <Directory Id="ProgramFilesFolder" Name="PFiles">
        <Directory Id="INSTALLDIR" Name="PHP52">
          <Component Id="gopearBAT" 
            DiskId="1" 
            Guid="C8385835-A5DD-4A90-9A44-5F49DE05B0B7">
            <File Id="file2" 
              Name="go-pear.bat" 
              Source="Files\go-pear.bat"/>
          </Component>
          <Component Id="installTXT" 
            DiskId="1" 
            Guid="D1055308-60DA-4C10-A29B-E582D0A3D675">
            <File Id="file3" 
              Name="install.txt" 
              Source="Files\install.txt"/>
          </Component>
          <Component Id="licenseTXT" 
            DiskId="1" 
            Guid="19D1F0B9-3655-4868-A8F1-F1B623577178">
            <File Id="file8" 
              Name="license.txt" 
              Source="Files\license.txt">
              <Shortcut Id="startmenuManual" 
                Directory="ProgramMenuDir" 
                Name="License" 
                LongName="License"/>
            </File>
          </Component>
          <Component Id="newsTXT" 
            DiskId="1"
            Guid="459AFF29-F8F5-4F0F-BC43-0DD4AA3D71F0">
            <File Id="file10" 
              Name="news.txt" 
              Source="Files\news.txt"/>
          </Component>
          <Component Id="readmedistbinsTXT" 
            DiskId="1" 
            Guid="23359910-5f6e-11de-8a39-0800200c9a66">
            <File Id="filereadmedistbinsTXT" 
            Name="README_1.TXT" 
            LongName="readme-redist-bins.txt"
            Source="Files\readme-redist-bins.txt"/>
          </Component>
          <Component Id="phpcgiEXE" 
            DiskId="1" 
            Guid="7ECF5817-CAB7-41EE-9E91-DDD2B1F5951B">
            <File Id="file12" 
            Name="php-cgi.exe" 
            Source="Files\php-cgi.exe"/>
          </Component>
          <Component Id="phpwinEXE" 
            DiskId="1" 
            Guid="BA2ADC66-E28C-4D5F-B4DA-E5F0874B2A10">
            <File Id="file13" 
              Name="php-win.exe" 
              Source="Files\php-win.exe"/>
          </Component>
          <Component Id="RegisterPHPFilesREG" 
            DiskId="1" 
            Guid="BFEFFADA-23EF-47B7-91E7-49AF35F50D24">
            <ProgId Id="PHPFile" 
              Description="PHP Script">
              <Extension Id="php" 
                ContentType="application/php">
                <Verb Id="open" 
                  Sequence="10" 
                  Command="Run" 
                  Target="[!file13]" 
                  Argument="&quot;%1&quot;"/>
              </Extension>
            </ProgId>
          </Component>
          <Component Id="PHPRegistry" 
            DiskId="1" 
            Guid="A769E623-7884-43E4-B774-0B3649D9573C">
            <Registry Id='PHPRegistryInstallDir' 
              Root='HKLM' 
              Key='Software\PHP52' 
              Name='InstallDir'
              Action='write' 
              Type='string' 
              Value='[INSTALLDIR]' />
            <Registry Id='PHPRegistryVersion' 
              Root='HKLM' 
              Key='Software\PHP52' 
              Name='Version'
              Action='write' 
              Type='string' 
              Value='5.2.0' />
          </Component>
          <Component Id="phpEXE" 
            DiskId="1" 
            Guid="65C8E630-59D4-41FC-99C5-54E99C74968F">
            <File Id="file14" 
              Name="php.exe" 
              Source="Files\php.exe"/>
            <Environment Id="phpEXEAddToPath" 
              Name="PATH" 
              Action="create" 
              System="yes" 
              Part="first" 
              Value="[INSTALLDIR]"/>
          </Component>
          <Component Id="phpGIF" 
            DiskId="1" 
            Guid="962C10B2-FD98-4D90-8607-68DE0932A814">
            <File Id="file15" 
              Name="php.gif" 
              Source="Files\php.gif"/>
          </Component>
          <Component Id="phprecommendedINI" 
            DiskId="1" 
            Guid="1301D912-68E0-4195-8197-0ED2DC6D9152"
            Permanent="yes">
            <File Id="file17" 
              Name="PHP_2.INI" 
              LongName="php.ini" 
              Source="Files\php.ini" >
              <Shortcut Id="startmenuPHPINI" 
                Directory="ProgramMenuDir" 
                Name="php.ini" 
                LongName="php.ini"/>
            </File>
            <IniFile Id="uploadtmpdirINI" 
              Action="addLine" 
              Key="upload_tmp_dir" 
              Directory="INSTALLDIR" 
              Name="php.ini" 
              Section="PHP" 
              Value="&quot;[%windir]\Temp&quot;"/>
            <IniFile Id="sessionsavepathINI" 
              Action="addLine" 
              Key="session.save_path" 
              Directory="INSTALLDIR" 
              Name="php.ini" 
              Section="PHP" 
              Value="&quot;[%windir]\Temp&quot;"/>
            <Condition>NOT PHPINIEXISTS</Condition>
          </Component>
          <Component Id="php5embedLIB" 
            DiskId="1" 
            Guid="8C0B065E-41DB-43DB-ABB2-716BE38988C7">
            <File Id="file22" 
              Name="PHP5EM_1.LIB" 
              LongName="php5embed.lib" 
              Source="Files\php5embed.lib"/>
          </Component>
          <Component Id="win2003eventlog" 
            DiskId="1"
            Guid="395E2C19-A3F3-468F-B03E-8D68F2F14746">
            <Registry Id="w2k3EventMessageFile" 
              Root="HKLM" 
              Key="System\CurrentControlSet\Services\EventLog\Application\PHP52" 
              Action="write" 
              Type="string"
              Name="EventMessageFile"
              Value="[INSTALLDIR]\dev\php5ts.dll"/>
            <Registry Id="w2k3TypesSupported" 
              Root="HKLM" 
              Key="System\CurrentControlSet\Services\EventLog\Application\PHP52"
              Action="write" 
              Type="integer" 
              Name="TypesSupported"
              Value="7"/>
            <Condition>VersionNT = 502</Condition>
          </Component>
          <Component Id="errorlog"
            DiskId="1"
            Guid="C90F9100-7234-11DE-8A39-0800200C9A66">
            <IniFile Id="logerrorsINI" Action="addLine" 
              Key="log_errors" Directory="INSTALLDIR" Name="php.ini"
              Section="PHP" Value="On" />
            <IniFile Id="errorlogINI" Action="addLine" 
              Key="error_log" Directory="INSTALLDIR" Name="php.ini"
              Section="PHP" Value="&quot;[%windir]\temp\php52-errors.log&quot;" />
          </Component>
          <Component Id="php5DLL" 
            DiskId="1" 
            Guid="14A95C34-564F-4BF9-BFC7-0DAA48A96BA2">
            <File Id="file25" 
              Name="php5.dll" 
              Source="Files\php5.dll"/>
          </Component>
          <Component Id="phpCHM" 
            DiskId="1" 
            Guid="F8B34349-76BD-4AEB-9033-A8AC48C13CDF">
            <File Id="file182" 
              Name="PHP_MA_1.DLL" 
              LongName="php_manual_en.chm" 
              Source="Files\php_manual_en.chm">
              <Shortcut Id="startmenuphpCMH" 
                Directory="ProgramMenuDir" 
                Name="Manual" 
                LongName="PHP Manual"/>
            </File>
          </Component>
          <Component Id="Empty" 
            DiskId="1" 
            Guid="24C87A13-FDBA-489B-AE2D-F9406EBA265A"/>
          <Directory Id="devdirectory" 
            Name="dev">
            <Component Id="php5LIB" 
              DiskId="1" 
              Guid="52593C5C-6709-49B9-B1C0-6729C977DE65">
              <File Id="file30" 
                Name="php5.lib" 
                Source="Files\dev\php5.lib"/>
            </Component>
          </Directory>
          <Directory Id="PEARdirectory" 
            Name="PEAR">
            <Component Id="gopearPHAR" 
              DiskId="1" 
              Guid="F3B9AE05-9E15-4E06-8192-91C513C8209A">
              <File Id="file181" 
                Name="GO-PEA_1.PHA" 
                LongName="go-pear.phar" 
                Source="Files\PEAR\go-pear.phar"/>
            </Component>
          </Directory>
        </Directory>
      </Directory>
      <Directory Id="ProgramMenuFolder" 
        Name="PMenu" 
        LongName="Programs">
        <Directory Id="ProgramMenuDir" 
          Name="PHP5.2" 
          LongName="PHP 5.2"/>
      </Directory>
      <Directory Id="usrdirectory" Name="usr">
          <Directory Id="mibsdirectory" Name="mibs" />
      </Directory>
    </Directory>
    <Feature AllowAdvertise="no" 
      Id="Complete" 
      Title="$(loc.FeatureCompleteTitle)" 
      Description="$(loc.FeatureCompleteDescription)" 
      TypicalDefault="install" 
      Display="expand" 
      ConfigurableDirectory="INSTALLDIR" 
      Level="1">
      <ComponentRef Id="licenseTXT"/>
      <ComponentRef Id="newsTXT"/>
      <ComponentRef Id="readmedistbinsTXT"/>
      <ComponentRef Id="installTXT"/>
      <ComponentRef Id="phpGIF"/>
      <ComponentRef Id="phprecommendedINI"/>
      <ComponentRef Id="win2003eventlog"/>
      <ComponentRef Id="PHPRegistry"/>
      <ComponentRef Id="php5DLL"/>
      <ComponentRef Id="php5LIB"/>
      <ComponentRef Id="php5embedLIB"/>
      <ComponentRef Id="phpEXE"/>
      <ComponentRef Id="errorlog"/>
        <Feature AllowAdvertise="no" 
          Id="ScriptExecutable" 
          Title="$(loc.FeatureScriptExecutableTitle)" 
          Description="$(loc.FeatureScriptExecutableDescription)" 
          Level="10">
          <ComponentRef Id="phpwinEXE"/>
          <Feature AllowAdvertise="no" 
            Id="RegisterPHPFiles" 
            Title="$(loc.FeatureRegisterPHPFilesTitle)" 
            Description="$(loc.FeatureRegisterPHPFilesDescription)" 
            Level="10">
            <ComponentRef Id="RegisterPHPFilesREG"/>
          </Feature>
        </Feature>
    
      <FeatureRef Id="Extensions"/>
      
      <Feature AllowAdvertise="no" 
        Id="WebServers" 
        Title="$(loc.FeatureWebServersTitle)" 
        Description="$(loc.FeatureWebServersDescription)"
        Display="hidden"
        Level="10">
        <ComponentRef Id="Empty"/>
        <Feature AllowAdvertise="no" 
          Id="iis4ISAPI" 
          Title="$(loc.Featureiis4ISAPITitle)" 
          Description="$(loc.Featureiis4ISAPIDescription)" 
          Level="10">
        </Feature>
        <Feature AllowAdvertise="no" 
          Id="iis4CGI" 
          Title="$(loc.Featureiis4CGITitle)" 
          Description="$(loc.Featureiis4CGIDescription)" 
          Level="1">
        </Feature>
        <Feature AllowAdvertise="no" 
          Id="iis4FastCGI" 
          Title="$(loc.Featureiis4FastCGITitle)" 
          Description="$(loc.Featureiis4FastCGIDescription)" 
          Level="1">
          <ComponentRef Id="phpcgiEXE"/>
          <ComponentRef Id="cgiforceredirect"/>
          <ComponentRef Id="fastcgiimpersonate"/>
          <ComponentRef Id="fastcgilogging"/>
          <ComponentRef Id="maxexecutiontime" />
          <ComponentRef Id="iis4FastCGIregistry"/>
        </Feature>
        <Feature AllowAdvertise="no" 
          Id="cgi" 
          Title="$(loc.FeaturecgiTitle)" 
          Description="$(loc.FeaturecgiDescription)" 
          Level="1">
          <ComponentRef Id="phpcgiEXE"/>
          <ComponentRef Id="cgiregistry"/>
        </Feature>
        <Feature AllowAdvertise="no" 
          Id="noconfig" 
          Title="$(loc.FeaturecgiTitle)" 
          Description="$(loc.FeaturecgiDescription)" 
          Level="1">
          <ComponentRef Id="noconfigregistry"/>
        </Feature>
      </Feature>
      
      <Feature AllowAdvertise="no" 
        Id="extras" 
        Title="$(loc.FeatureextrasTitle)" 
        Description="$(loc.FeatureextrasDescription)" 
        Level="10">
        <ComponentRef Id="Empty"/>
        <Feature AllowAdvertise="no" 
          Id="PEAR" 
          Title="$(loc.FeaturePEARTitle)" 
          Description="$(loc.FeaturePEARDescription)" 
          Level="1">
          <ComponentRef Id="gopearPHAR"/>
          <ComponentRef Id="gopearBAT"/>
        </Feature>
        <Feature AllowAdvertise="no" 
          Id="Manual" 
          Title="$(loc.FeatureManualTitle)" 
          Description="$(loc.FeatureManualDescription)" 
          Level="1">
          <ComponentRef Id="phpCHM"/>
        </Feature>
      </Feature>
    </Feature>

    <Binary Id="PHPInstallerScripts" SourceFile="PHPInstallerScripts52.vbs" /> 
    <Binary Id="WixCA" src="Wix\wixca.dll"/>

    <CustomAction Id="iis700FastCGIaddCmd"
      Property="iis700FastCGIadd"
      Value="&quot;[WindowsFolder]system32\inetsrv\APPCMD.EXE&quot; SET CONFIG -section:system.webServer/fastCGI /+&quot;[\[]fullPath='[INSTALLDIR]php-cgi.exe'[\]]&quot;" />
    <CustomAction Id="iis700FastCGIadd" 
      BinaryKey="WixCA" 
      DllEntry="CAQuietExec" 
      Return="ignore" 
      Execute="deferred"
      Impersonate="no" />
    <CustomAction Id="iis700FastCGISetInstanceMaxRequestsCmd"
      Property="iis700FastCGISetInstanceMaxRequests"
      Value="&quot;[WindowsFolder]system32\inetsrv\APPCMD.EXE&quot; SET CONFIG -section:system.webServer/fastCGI &quot;/[\[]fullPath='[INSTALLDIR]php-cgi.exe'[\]].instanceMaxRequests:10000&quot; /commit:apphost" />
    <CustomAction Id="iis700FastCGISetInstanceMaxRequests" 
      BinaryKey="WixCA" 
      DllEntry="CAQuietExec" 
      Return="ignore" 
      Execute="deferred"
      Impersonate="no" />
    <CustomAction Id="iis700FastCGISetActivityTimeoutCmd"
      Property="iis700FastCGISetActivityTimeout"
      Value="&quot;[WindowsFolder]system32\inetsrv\APPCMD.EXE&quot; SET CONFIG -section:system.webServer/fastCGI &quot;/[\[]fullPath='[INSTALLDIR]php-cgi.exe'[\]].activityTimeout:600&quot; /commit:apphost" />
    <CustomAction Id="iis700FastCGISetActivityTimeout" 
      BinaryKey="WixCA" 
      DllEntry="CAQuietExec" 
      Return="ignore" 
      Execute="deferred"
      Impersonate="no" />
    <CustomAction Id="iis700FastCGISetRequestTimeoutCmd"
      Property="iis700FastCGISetRequestTimeout"
      Value="&quot;[WindowsFolder]system32\inetsrv\APPCMD.EXE&quot; SET CONFIG -section:system.webServer/fastCGI &quot;/[\[]fullPath='[INSTALLDIR]php-cgi.exe'[\]].requestTimeout:600&quot; /commit:apphost" />
    <CustomAction Id="iis700FastCGISetRequestTimeout"
      BinaryKey="WixCA" 
      DllEntry="CAQuietExec" 
      Return="ignore" 
      Execute="deferred"
      Impersonate="no" />
    <CustomAction Id="iis700FastCGISetPHP_FCGI_MAX_REQUESTSCmd"
      Property="iis700FastCGISetPHP_FCGI_MAX_REQUESTS"
      Value="&quot;[WindowsFolder]system32\inetsrv\APPCMD.EXE&quot; SET CONFIG -section:system.webServer/fastCGI /+&quot;[\[]fullPath='[INSTALLDIR]php-cgi.exe'[\]].environmentVariables.[\[]name='PHP_FCGI_MAX_REQUESTS',value='10000'[\]]&quot; /commit:apphost" />
    <CustomAction Id="iis700FastCGISetPHP_FCGI_MAX_REQUESTS" 
      BinaryKey="WixCA" 
      DllEntry="CAQuietExec" 
      Return="ignore" 
      Execute="deferred"
      Impersonate="no" />
    <CustomAction Id="iis700FastCGISetPHPRCCmd"
      Property="iis700FastCGISetPHPRC"
      Value="&quot;[WindowsFolder]system32\inetsrv\APPCMD.EXE&quot; SET CONFIG -section:system.webServer/fastCGI /+&quot;[\[]fullPath='[INSTALLDIR]php-cgi.exe'[\]].environmentVariables.[\[]name='PHPRC',value='[INSTALLDIR]'[\]]&quot; /commit:apphost" />
    <CustomAction Id="iis700FastCGISetPHPRC" 
      BinaryKey="WixCA" DllEntry="CAQuietExec" Return="ignore" 
      Execute="deferred"
      Impersonate="no" />
    <CustomAction Id="iis700FastCGICmd"
      Property="iis700FastCGI"
      Value="&quot;[WindowsFolder]system32\inetsrv\APPCMD.EXE&quot; SET CONFIG -section:system.webServer/handlers /+&quot;[\[]name='PHP52_via_FastCGI',path='*.php',verb='*',modules='FastCgiModule',scriptProcessor='[INSTALLDIR]php-cgi.exe',resourceType='Either'[\]]&quot;" />
    <CustomAction Id="iis700FastCGI" 
      BinaryKey="WixCA" 
      DllEntry="CAQuietExec" 
      Return="ignore" 
      Execute="deferred"
      Impersonate="no" />
    <CustomAction Id="iis700IndexPhpCmd"
      Property="iis700IndexPhp"
      Value="&quot;[WindowsFolder]system32\inetsrv\APPCMD.EXE&quot; SET CONFIG -section:system.webServer/defaultDocument /+&quot;files.[\[]@end,value='index.php'[\]]&quot;" />
    <CustomAction Id="iis700IndexPhp"
      BinaryKey="WixCA"
      DllEntry="CAQuietExec"
      Return="ignore"
      Execute="deferred"
      Impersonate="no" />
    <CustomAction Id="iis700FastCGIaddremoveCmd"
      Property="iis700FastCGIaddremove"
      Value="&quot;[WindowsFolder]system32\inetsrv\APPCMD.EXE&quot; SET CONFIG -section:system.webServer/fastCGI /-&quot;[\[]fullPath='[INSTALLDIR]php-cgi.exe'[\]]&quot;" />
    <CustomAction Id="iis700FastCGIaddremove" 
      BinaryKey="WixCA" 
      DllEntry="CAQuietExec" 
      Return="ignore" 
      Execute="deferred"
      Impersonate="no" />
    <CustomAction Id="iis700FastCGIremoveCmd"
      Property="iis700FastCGIremove"
      Value="&quot;[WindowsFolder]system32\inetsrv\APPCMD.EXE&quot; SET CONFIG -section:system.webServer/handlers /-&quot;[\[]name='PHP52_via_FastCGI',path='*.php',verb='*'[\]]&quot;" />
    <CustomAction Id="iis700FastCGIremove" 
      BinaryKey="WixCA"
      DllEntry="CAQuietExec" 
      Return="ignore"
      Execute="deferred"
      Impersonate="no" />
    <CustomAction Id="fcgiconfigJSFastCGICmd"
      Property="fcgiconfigJSFastCGI"
      Value="&quot;\\localhost\admin$\system32\cscript.exe&quot; &quot;[WindowsFolder]system32\inetsrv\fcgiconfig.js&quot; -add -section:&quot;PHP&quot; -extension:php -path:&quot;php-cgi.exe&quot;" />
    <CustomAction Id="fcgiconfigJSFastCGI" 
      BinaryKey="WixCA"
      DllEntry="CAQuietExec" 
      Return="ignore"
      Execute="deferred"
      Impersonate="no" />
    <CustomAction Id="fcgiconfigJSFastCGICmdXP"
      Property="fcgiconfigJSFastCGIXP"
      Value="&quot;cscript&quot; &quot;[WindowsFolder]system32\inetsrv\fcgiconfig.js&quot; -add -section:&quot;PHP&quot; -extension:php -path:&quot;php-cgi.exe&quot;" />
    <CustomAction Id="fcgiconfigJSFastCGIXP"
      BinaryKey="WixCA"
      DllEntry="CAQuietExec" 
      Return="ignore"
      Execute="deferred"
      Impersonate="no" />      
    <CustomAction Id="fcgiconfigJSFastCGISetExePathCmd"
      Property="fcgiconfigJSFastCGISetExePath"
      Value="&quot;\\localhost\admin$\system32\cscript.exe&quot; &quot;[WindowsFolder]system32\inetsrv\fcgiconfig.js&quot; -set -section:&quot;PHP&quot; -ExePath:&quot;[INSTALLDIR]php-cgi.exe&quot;" />
    <CustomAction Id="fcgiconfigJSFastCGISetExePath"
      BinaryKey="WixCA"
      DllEntry="CAQuietExec" 
      Return="ignore"
      Execute="deferred"
      Impersonate="no" />
    <CustomAction Id="fcgiconfigJSFastCGISetExePathCmdXP"
      Property="fcgiconfigJSFastCGISetExePathXP"
      Value="&quot;cscript&quot; &quot;[WindowsFolder]system32\inetsrv\fcgiconfig.js&quot; -set -section:&quot;PHP&quot; -ExePath:&quot;[INSTALLDIR]php-cgi.exe&quot;" />
    <CustomAction Id="fcgiconfigJSFastCGISetExePathXP" 
      BinaryKey="WixCA" 
      DllEntry="CAQuietExec" 
      Return="ignore"
      Execute="deferred"
      Impersonate="no" />
    <CustomAction Id="fcgiconfigJSFastCGISetInstanceMaxRequestsCmd"
      Property="fcgiconfigJSFastCGISetInstanceMaxRequests"
      Value="&quot;\\localhost\admin$\system32\cscript.exe&quot; &quot;[WindowsFolder]system32\inetsrv\fcgiconfig.js&quot; -set -section:&quot;PHP&quot; -InstanceMaxRequests:10000" />
    <CustomAction Id="fcgiconfigJSFastCGISetInstanceMaxRequests" 
      BinaryKey="WixCA" 
      DllEntry="CAQuietExec" 
      Return="ignore"
      Execute="deferred"
      Impersonate="no" />
    <CustomAction Id="fcgiconfigJSFastCGISetInstanceMaxRequestsCmdXP"
      Property="fcgiconfigJSFastCGISetInstanceMaxRequestsXP"
      Value="&quot;cscript&quot; &quot;[WindowsFolder]system32\inetsrv\fcgiconfig.js&quot; -set -section:&quot;PHP&quot; -InstanceMaxRequests:10000" />
    <CustomAction Id="fcgiconfigJSFastCGISetInstanceMaxRequestsXP" 
      BinaryKey="WixCA" 
      DllEntry="CAQuietExec" 
      Return="ignore"
      Execute="deferred"
      Impersonate="no" />
    <CustomAction Id="fcgiconfigJSFastCGISetActivityTimeoutCmd"
      Property="fcgiconfigJSFastCGISetActivityTimeout"
      Value="&quot;\\localhost\admin$\system32\cscript.exe&quot; &quot;[WindowsFolder]system32\inetsrv\fcgiconfig.js&quot; -set -section:&quot;PHP&quot; -ActivityTimeout:600" />
    <CustomAction Id="fcgiconfigJSFastCGISetActivityTimeout"
      BinaryKey="WixCA" 
      DllEntry="CAQuietExec" 
      Return="ignore"
      Execute="deferred"
      Impersonate="no" />
    <CustomAction Id="fcgiconfigJSFastCGISetActivityTimeoutCmdXP"
      Property="fcgiconfigJSFastCGISetActivityTimeoutXP"
      Value="&quot;cscript&quot; &quot;[WindowsFolder]system32\inetsrv\fcgiconfig.js&quot; -set -section:&quot;PHP&quot; -ActivityTimeout:600" />
    <CustomAction Id="fcgiconfigJSFastCGISetActivityTimeoutXP"
      BinaryKey="WixCA" 
      DllEntry="CAQuietExec" 
      Return="ignore"
      Execute="deferred"
      Impersonate="no" />
    <CustomAction Id="fcgiconfigJSFastCGISetRequestTimeoutCmd"
      Property="fcgiconfigJSFastCGISetRequestTimeout"
      Value="&quot;\\localhost\admin$\system32\cscript.exe&quot; &quot;[WindowsFolder]system32\inetsrv\fcgiconfig.js&quot; -set -section:&quot;PHP&quot; -RequestTimeout:600" />
    <CustomAction Id="fcgiconfigJSFastCGISetRequestTimeout"
      BinaryKey="WixCA" 
      DllEntry="CAQuietExec" 
      Return="ignore"
      Execute="deferred"
      Impersonate="no" />
    <CustomAction Id="fcgiconfigJSFastCGISetRequestTimeoutCmdXP"
      Property="fcgiconfigJSFastCGISetRequestTimeoutXP"
      Value="&quot;cscript&quot; &quot;[WindowsFolder]system32\inetsrv\fcgiconfig.js&quot; -set -section:&quot;PHP&quot; -RequestTimeout:600" />
    <CustomAction Id="fcgiconfigJSFastCGISetRequestTimeoutXP" 
      BinaryKey="WixCA" 
      DllEntry="CAQuietExec" 
      Return="ignore"
      Execute="deferred"
      Impersonate="no" />
    <CustomAction Id="fcgiconfigJSFastCGISetPHPRCAndMAX_REQUESTSCmd"
      Property="fcgiconfigJSFastCGISetPHPRCAndMAX_REQUESTS"
      Value="&quot;\\localhost\admin$\system32\cscript.exe&quot; &quot;[WindowsFolder]system32\inetsrv\fcgiconfig.js&quot; -set -section:&quot;PHP&quot; -EnvironmentVars:PHP_FCGI_MAX_REQUESTS:10000,PHPRC:&quot;[INSTALLDIR]&quot;" />
    <CustomAction Id="fcgiconfigJSFastCGISetPHPRCAndMAX_REQUESTS" 
      BinaryKey="WixCA" 
      DllEntry="CAQuietExec" 
      Return="ignore"
      Execute="deferred"
      Impersonate="no" />
    <CustomAction Id="fcgiconfigJSFastCGISetPHPRCAndMAX_REQUESTSCmdXP"
      Property="fcgiconfigJSFastCGISetPHPRCAndMAX_REQUESTSXP"
      Value="&quot;cscript&quot; &quot;[WindowsFolder]system32\inetsrv\fcgiconfig.js&quot; -set -section:&quot;PHP&quot; -EnvironmentVars:PHP_FCGI_MAX_REQUESTS:10000,PHPRC:&quot;[INSTALLDIR]&quot;" />
    <CustomAction Id="fcgiconfigJSFastCGISetPHPRCAndMAX_REQUESTSXP" 
      BinaryKey="WixCA" 
      DllEntry="CAQuietExec" 
      Return="ignore"
      Execute="deferred"
      Impersonate="no" />      
    <CustomAction Id="fcgiconfigJSFastCGIremoveCmd"
      Property="fcgiconfigJSFastCGIremove"
      Value="&quot;\\localhost\admin$\system32\cscript.exe&quot; &quot;[WindowsFolder]system32\inetsrv\fcgiconfig.js&quot; -remove -section:&quot;PHP&quot;" />
    <CustomAction Id="fcgiconfigJSFastCGIremove" 
      BinaryKey="WixCA" 
      DllEntry="CAQuietExec" 
      Return="ignore"
      Execute="deferred"
      Impersonate="no" />
    <CustomAction Id="fcgiconfigJSFastCGIremoveCmdXP"
      Property="fcgiconfigJSFastCGIremoveXP"
      Value="&quot;cscript&quot; &quot;[WindowsFolder]system32\inetsrv\fcgiconfig.js&quot; -remove -section:&quot;PHP&quot;" />            
    <CustomAction Id="fcgiconfigJSFastCGIremoveXP" 
      BinaryKey="WixCA" 
      DllEntry="CAQuietExec" 
      Return="ignore"
      Execute="deferred"
      Impersonate="no" />      
    <CustomAction Id="fcgiconfigJSFastCGIrehook53SetExePathCmd"
      Property="fcgiconfigJSFastCGIrehook53SetExePath"
      Value="&quot;\\localhost\admin$\system32\cscript.exe&quot; &quot;[WindowsFolder]system32\inetsrv\fcgiconfig.js&quot; -set -section:&quot;PHP&quot; -ExePath:&quot;[PHP53INSTALLDIR]php-cgi.exe&quot;" />
    <CustomAction Id="fcgiconfigJSFastCGIrehook53SetExePath"
      BinaryKey="WixCA"
      DllEntry="CAQuietExec" 
      Return="ignore"
      Execute="deferred"
      Impersonate="no" />
    <CustomAction Id="fcgiconfigJSFastCGIrehook53SetExePathCmdXP"
      Property="fcgiconfigJSFastCGIrehook53SetExePathXP"
      Value="&quot;cscript&quot; &quot;[WindowsFolder]system32\inetsrv\fcgiconfig.js&quot; -set -section:&quot;PHP&quot; -ExePath:&quot;[PHP53INSTALLDIR]php-cgi.exe&quot;" />
    <CustomAction Id="fcgiconfigJSFastCGIrehook53SetExePathXP" 
      BinaryKey="WixCA" 
      DllEntry="CAQuietExec" 
      Return="ignore"
      Execute="deferred"
      Impersonate="no" />
    <CustomAction Id="fcgiconfigJSFastCGIrehook53SetPHPRCAndMAX_REQUESTSCmd"
      Property="fcgiconfigJSFastCGIrehook53SetPHPRCAndMAX_REQUESTS"
      Value="&quot;\\localhost\admin$\system32\cscript.exe&quot; &quot;[WindowsFolder]system32\inetsrv\fcgiconfig.js&quot; -set -section:&quot;PHP&quot; -EnvironmentVars:PHP_FCGI_MAX_REQUESTS:10000,PHPRC:&quot;[PHP53INSTALLDIR]&quot;" />
    <CustomAction Id="fcgiconfigJSFastCGIrehook53SetPHPRCAndMAX_REQUESTS" 
      BinaryKey="WixCA" 
      DllEntry="CAQuietExec" 
      Return="ignore"
      Execute="deferred"
      Impersonate="no" />
    <CustomAction Id="fcgiconfigJSFastCGIrehook53SetPHPRCAndMAX_REQUESTSCmdXP"
      Property="fcgiconfigJSFastCGIrehook53SetPHPRCAndMAX_REQUESTSXP"
      Value="&quot;cscript&quot; &quot;[WindowsFolder]system32\inetsrv\fcgiconfig.js&quot; -set -section:&quot;PHP&quot; -EnvironmentVars:PHP_FCGI_MAX_REQUESTS:10000,PHPRC:&quot;[PHP53INSTALLDIR]&quot;" />
    <CustomAction Id="fcgiconfigJSFastCGIrehook53SetPHPRCAndMAX_REQUESTSXP" 
      BinaryKey="WixCA" 
      DllEntry="CAQuietExec" 
      Return="ignore"
      Execute="deferred"
      Impersonate="no" />
    <CustomAction Id="fcgiconfigJSFastCGIrehook60SetExePathCmd"
      Property="fcgiconfigJSFastCGIrehook60SetExePath"
      Value="&quot;\\localhost\admin$\system32\cscript.exe&quot; &quot;[WindowsFolder]system32\inetsrv\fcgiconfig.js&quot; -set -section:&quot;PHP&quot; -ExePath:&quot;[PHP60INSTALLDIR]php-cgi.exe&quot;" />
    <CustomAction Id="fcgiconfigJSFastCGIrehook60SetExePath"
      BinaryKey="WixCA"
      DllEntry="CAQuietExec" 
      Return="ignore"
      Execute="deferred"
      Impersonate="no" />
    <CustomAction Id="fcgiconfigJSFastCGIrehook60SetExePathCmdXP"
      Property="fcgiconfigJSFastCGIrehook60SetExePathXP"
      Value="&quot;cscript&quot; &quot;[WindowsFolder]system32\inetsrv\fcgiconfig.js&quot; -set -section:&quot;PHP&quot; -ExePath:&quot;[PHP60INSTALLDIR]php-cgi.exe&quot;" />
    <CustomAction Id="fcgiconfigJSFastCGIrehook60SetExePathXP" 
      BinaryKey="WixCA" 
      DllEntry="CAQuietExec" 
      Return="ignore"
      Execute="deferred"
      Impersonate="no" />
    <CustomAction Id="fcgiconfigJSFastCGIrehook60SetPHPRCAndMAX_REQUESTSCmd"
      Property="fcgiconfigJSFastCGIrehook60SetPHPRCAndMAX_REQUESTS"
      Value="&quot;\\localhost\admin$\system32\cscript.exe&quot; &quot;[WindowsFolder]system32\inetsrv\fcgiconfig.js&quot; -set -section:&quot;PHP&quot; -EnvironmentVars:PHP_FCGI_MAX_REQUESTS:10000,PHPRC:&quot;[PHP60INSTALLDIR]&quot;" />
    <CustomAction Id="fcgiconfigJSFastCGIrehook60SetPHPRCAndMAX_REQUESTS" 
      BinaryKey="WixCA" 
      DllEntry="CAQuietExec" 
      Return="ignore"
      Execute="deferred"
      Impersonate="no" />
    <CustomAction Id="fcgiconfigJSFastCGIrehook60SetPHPRCAndMAX_REQUESTSCmdXP"
      Property="fcgiconfigJSFastCGIrehook60SetPHPRCAndMAX_REQUESTSXP"
      Value="&quot;cscript&quot; &quot;[WindowsFolder]system32\inetsrv\fcgiconfig.js&quot; -set -section:&quot;PHP&quot; -EnvironmentVars:PHP_FCGI_MAX_REQUESTS:10000,PHPRC:&quot;[PHP60INSTALLDIR]&quot;" />
    <CustomAction Id="fcgiconfigJSFastCGIrehook60SetPHPRCAndMAX_REQUESTSXP" 
      BinaryKey="WixCA" 
      DllEntry="CAQuietExec" 
      Return="ignore"
      Execute="deferred"
      Impersonate="no" />
    <CustomAction Id="configIIS4" 
      BinaryKey="PHPInstallerScripts" 
      Return="check" 
      Execute="deferred"
      Impersonate="no" 
      VBScriptCall="configIIS4" />
    <CustomAction Id="configIIS4CustomActionDataValue" 
      Return="check" 
      Property="configIIS4" 
      Value="[INSTALLDIR]" />
    <CustomAction Id="unconfigIIS4" 
      BinaryKey="PHPInstallerScripts" 
      Return="check" 
      Execute="deferred"
      Impersonate="no" 
      VBScriptCall="unconfigIIS4" />
 
    <InstallExecuteSequence>
      <Custom Action="iis700FastCGIaddCmd" After="InstallInitialize">
        <![CDATA[VersionNT >= 600 AND &iis4FastCGI = 3]]>
      </Custom>
      <Custom Action="iis700FastCGIadd" After="iis700FastCGIaddCmd">
        <![CDATA[VersionNT >= 600 AND &iis4FastCGI = 3]]>
      </Custom>
      <Custom Action="iis700FastCGISetInstanceMaxRequestsCmd" After="iis700FastCGIadd">
        <![CDATA[VersionNT >= 600 AND &iis4FastCGI = 3]]>
      </Custom>
      <Custom Action="iis700FastCGISetInstanceMaxRequests" After="iis700FastCGISetInstanceMaxRequestsCmd">
        <![CDATA[VersionNT >= 600 AND &iis4FastCGI = 3]]>
      </Custom>
      <Custom Action="iis700FastCGISetActivityTimeoutCmd" After="iis700FastCGISetInstanceMaxRequests">
        <![CDATA[VersionNT >= 600 AND &iis4FastCGI = 3]]>
      </Custom>
      <Custom Action="iis700FastCGISetActivityTimeout" After="iis700FastCGISetActivityTimeoutCmd">
        <![CDATA[VersionNT >= 600 AND &iis4FastCGI = 3]]>
      </Custom>
      <Custom Action="iis700FastCGISetRequestTimeoutCmd" After="iis700FastCGISetActivityTimeout">
        <![CDATA[VersionNT >= 600 AND &iis4FastCGI = 3]]>
      </Custom>
      <Custom Action="iis700FastCGISetRequestTimeout" After="iis700FastCGISetRequestTimeoutCmd">
        <![CDATA[VersionNT >= 600 AND &iis4FastCGI = 3]]>
      </Custom>
      <Custom Action="iis700FastCGISetPHP_FCGI_MAX_REQUESTSCmd" After="iis700FastCGISetRequestTimeout">
        <![CDATA[VersionNT >= 600 AND &iis4FastCGI = 3]]>
      </Custom>
      <Custom Action="iis700FastCGISetPHP_FCGI_MAX_REQUESTS" After="iis700FastCGISetPHP_FCGI_MAX_REQUESTSCmd">
        <![CDATA[VersionNT >= 600 AND &iis4FastCGI = 3]]>
      </Custom>
      <Custom Action="iis700FastCGISetPHPRCCmd" After="iis700FastCGISetPHP_FCGI_MAX_REQUESTS">
        <![CDATA[VersionNT >= 600 AND &iis4FastCGI = 3]]>
      </Custom>
      <Custom Action="iis700FastCGISetPHPRC" After="iis700FastCGISetPHPRCCmd">
        <![CDATA[VersionNT >= 600 AND &iis4FastCGI = 3]]>
      </Custom>
      <Custom Action="iis700FastCGICmd" After="iis700FastCGISetPHPRC">
        <![CDATA[VersionNT >= 600 AND &iis4FastCGI = 3]]>
      </Custom>
      <Custom Action="iis700FastCGI" After="iis700FastCGICmd">
        <![CDATA[VersionNT >= 600 AND &iis4FastCGI = 3]]>
      </Custom>
      <Custom Action="iis700IndexPhpCmd" After="iis700FastCGI">
        <![CDATA[VersionNT >= 600 AND &iis4FastCGI = 3]]>
      </Custom>
      <Custom Action="iis700IndexPhp" After="iis700IndexPhpCmd">
        <![CDATA[VersionNT >= 600 AND &iis4FastCGI = 3]]>
      </Custom>
      <Custom Action="iis700FastCGIremoveCmd" After="InstallInitialize">
        <![CDATA[VersionNT >= 600 AND &iis4FastCGI = 2]]>
      </Custom>
      <Custom Action="iis700FastCGIremove" After="iis700FastCGIremoveCmd">
        <![CDATA[VersionNT >= 600 AND &iis4FastCGI = 2]]>
      </Custom>
      <Custom Action="iis700FastCGIaddremoveCmd" After="iis700FastCGIremove">
        <![CDATA[VersionNT >= 600 AND &iis4FastCGI = 2]]>
      </Custom>
      <Custom Action="iis700FastCGIaddremove" After="iis700FastCGIaddremoveCmd">
        <![CDATA[VersionNT >= 600 AND &iis4FastCGI = 2]]>
      </Custom>
      <Custom Action="fcgiconfigJSFastCGICmd" After="InstallInitialize">
        <![CDATA[(VersionNT = 502 AND ServicePackLevel >= 2) AND &iis4FastCGI = 3]]>
      </Custom>
      <Custom Action="fcgiconfigJSFastCGI" After="fcgiconfigJSFastCGICmd">
        <![CDATA[(VersionNT = 502 AND ServicePackLevel >= 2) AND &iis4FastCGI = 3]]>
      </Custom>
      <Custom Action="fcgiconfigJSFastCGISetExePathCmd" After="fcgiconfigJSFastCGI">
        <![CDATA[(VersionNT = 502 AND ServicePackLevel >= 2) AND &iis4FastCGI = 3]]>
      </Custom>
      <Custom Action="fcgiconfigJSFastCGISetExePath" After="fcgiconfigJSFastCGISetExePathCmd">
        <![CDATA[(VersionNT = 502 AND ServicePackLevel >= 2) AND &iis4FastCGI = 3]]>
      </Custom>
      <Custom Action="fcgiconfigJSFastCGISetInstanceMaxRequestsCmd" After="fcgiconfigJSFastCGISetExePath">
        <![CDATA[(VersionNT = 502 AND ServicePackLevel >= 2) AND &iis4FastCGI = 3]]>
      </Custom>
      <Custom Action="fcgiconfigJSFastCGISetInstanceMaxRequests" After="fcgiconfigJSFastCGISetInstanceMaxRequestsCmd">
        <![CDATA[(VersionNT = 502 AND ServicePackLevel >= 2) AND &iis4FastCGI = 3]]>
      </Custom>
      <Custom Action="fcgiconfigJSFastCGISetActivityTimeoutCmd" After="fcgiconfigJSFastCGISetInstanceMaxRequests">
        <![CDATA[(VersionNT = 502 AND ServicePackLevel >= 2) AND &iis4FastCGI = 3]]>
      </Custom>
      <Custom Action="fcgiconfigJSFastCGISetActivityTimeout" After="fcgiconfigJSFastCGISetActivityTimeoutCmd">
        <![CDATA[(VersionNT = 502 AND ServicePackLevel >= 2) AND &iis4FastCGI = 3]]>
      </Custom>
      <Custom Action="fcgiconfigJSFastCGISetRequestTimeoutCmd" After="fcgiconfigJSFastCGISetActivityTimeout">
        <![CDATA[(VersionNT = 502 AND ServicePackLevel >= 2) AND &iis4FastCGI = 3]]>
      </Custom>
      <Custom Action="fcgiconfigJSFastCGISetRequestTimeout" After="fcgiconfigJSFastCGISetRequestTimeoutCmd">
        <![CDATA[(VersionNT = 502 AND ServicePackLevel >= 2) AND &iis4FastCGI = 3]]>
      </Custom>
      <Custom Action="fcgiconfigJSFastCGISetPHPRCAndMAX_REQUESTSCmd" After="fcgiconfigJSFastCGISetRequestTimeout">
        <![CDATA[(VersionNT = 502 AND ServicePackLevel >= 2) AND &iis4FastCGI = 3]]>
      </Custom>
      <Custom Action="fcgiconfigJSFastCGISetPHPRCAndMAX_REQUESTS" After="fcgiconfigJSFastCGISetPHPRCAndMAX_REQUESTSCmd">
        <![CDATA[(VersionNT = 502 AND ServicePackLevel >= 2) AND &iis4FastCGI = 3]]>
      </Custom>
      <Custom Action="fcgiconfigJSFastCGICmdXP" After="InstallInitialize">
        <![CDATA[(VersionNT = 501 AND ServicePackLevel >= 2) AND &iis4FastCGI = 3]]>
      </Custom>
      <Custom Action="fcgiconfigJSFastCGIXP" After="fcgiconfigJSFastCGICmdXP">
        <![CDATA[(VersionNT = 501 AND ServicePackLevel >= 2) AND &iis4FastCGI = 3]]>
      </Custom>
      <Custom Action="fcgiconfigJSFastCGISetExePathCmdXP" After="fcgiconfigJSFastCGIXP">
        <![CDATA[(VersionNT = 501 AND ServicePackLevel >= 2) AND &iis4FastCGI = 3]]>
      </Custom>
      <Custom Action="fcgiconfigJSFastCGISetExePathXP" After="fcgiconfigJSFastCGISetExePathCmdXP">
        <![CDATA[(VersionNT = 501 AND ServicePackLevel >= 2) AND &iis4FastCGI = 3]]>
      </Custom>
      <Custom Action="fcgiconfigJSFastCGISetInstanceMaxRequestsCmdXP" After="fcgiconfigJSFastCGISetExePathXP">
        <![CDATA[(VersionNT = 501 AND ServicePackLevel >= 2) AND &iis4FastCGI = 3]]>
      </Custom>
      <Custom Action="fcgiconfigJSFastCGISetInstanceMaxRequestsXP" After="fcgiconfigJSFastCGISetInstanceMaxRequestsCmdXP">
        <![CDATA[(VersionNT = 501 AND ServicePackLevel >= 2) AND &iis4FastCGI = 3]]>
      </Custom>
      <Custom Action="fcgiconfigJSFastCGISetActivityTimeoutCmdXP" After="fcgiconfigJSFastCGISetInstanceMaxRequestsXP">
        <![CDATA[(VersionNT = 501 AND ServicePackLevel >= 2) AND &iis4FastCGI = 3]]>
      </Custom>
      <Custom Action="fcgiconfigJSFastCGISetActivityTimeoutXP" After="fcgiconfigJSFastCGISetActivityTimeoutCmdXP">
        <![CDATA[(VersionNT = 501 AND ServicePackLevel >= 2) AND &iis4FastCGI = 3]]>
      </Custom>
      <Custom Action="fcgiconfigJSFastCGISetRequestTimeoutCmdXP" After="fcgiconfigJSFastCGISetActivityTimeoutXP">
        <![CDATA[(VersionNT = 501 AND ServicePackLevel >= 2) AND &iis4FastCGI = 3]]>
      </Custom>
      <Custom Action="fcgiconfigJSFastCGISetRequestTimeoutXP" After="fcgiconfigJSFastCGISetRequestTimeoutCmdXP">
        <![CDATA[(VersionNT = 501 AND ServicePackLevel >= 2) AND &iis4FastCGI = 3]]>
      </Custom>
      <Custom Action="fcgiconfigJSFastCGISetPHPRCAndMAX_REQUESTSCmdXP" After="fcgiconfigJSFastCGISetRequestTimeoutXP">
        <![CDATA[(VersionNT = 501 AND ServicePackLevel >= 2) AND &iis4FastCGI = 3]]>
      </Custom>
      <Custom Action="fcgiconfigJSFastCGISetPHPRCAndMAX_REQUESTSXP" After="fcgiconfigJSFastCGISetPHPRCAndMAX_REQUESTSCmdXP">
        <![CDATA[(VersionNT = 501 AND ServicePackLevel >= 2) AND &iis4FastCGI = 3]]>
      </Custom>
      <Custom Action="fcgiconfigJSFastCGIremoveCmd" After="InstallInitialize">
        <![CDATA[((VersionNT = 502 AND ServicePackLevel >= 2) AND &iis4FastCGI = 2) AND (NOT PHP53WEBSERVERTYPE = "iis4FastCGI") AND (NOT PHP60WEBSERVERTYPE = "iis4FastCGI")]]>
      </Custom>
      <Custom Action="fcgiconfigJSFastCGIremove" After="fcgiconfigJSFastCGIremoveCmd">
        <![CDATA[((VersionNT = 502 AND ServicePackLevel >= 2) AND &iis4FastCGI = 2) AND (NOT PHP53WEBSERVERTYPE = "iis4FastCGI") AND (NOT PHP60WEBSERVERTYPE = "iis4FastCGI")]]>
      </Custom>
      <Custom Action="fcgiconfigJSFastCGIrehook60SetExePathCmd" After="InstallInitialize">
        <![CDATA[(VersionNT = 502 AND ServicePackLevel >= 2) AND &iis4FastCGI = 2 AND (PHP60WEBSERVERTYPE = "iis4FastCGI")]]>
      </Custom>
      <Custom Action="fcgiconfigJSFastCGIrehook60SetExePath" After="fcgiconfigJSFastCGIrehook60SetExePathCmd">
        <![CDATA[(VersionNT = 502 AND ServicePackLevel >= 2) AND &iis4FastCGI = 2 AND (PHP60WEBSERVERTYPE = "iis4FastCGI")]]>
      </Custom>
      <Custom Action="fcgiconfigJSFastCGIrehook60SetPHPRCAndMAX_REQUESTSCmd" After="fcgiconfigJSFastCGIrehook60SetExePath">
        <![CDATA[(VersionNT = 502 AND ServicePackLevel >= 2) AND &iis4FastCGI = 2 AND (PHP60WEBSERVERTYPE = "iis4FastCGI")]]>
      </Custom>
      <Custom Action="fcgiconfigJSFastCGIrehook60SetPHPRCAndMAX_REQUESTS" After="fcgiconfigJSFastCGIrehook60SetPHPRCAndMAX_REQUESTSCmd">
        <![CDATA[(VersionNT = 502 AND ServicePackLevel >= 2) AND &iis4FastCGI = 2 AND (PHP60WEBSERVERTYPE = "iis4FastCGI")]]>
      </Custom>
      <Custom Action="fcgiconfigJSFastCGIrehook53SetExePathCmd" After="fcgiconfigJSFastCGIrehook60SetPHPRCAndMAX_REQUESTS">
        <![CDATA[(VersionNT = 502 AND ServicePackLevel >= 2) AND &iis4FastCGI = 2 AND (PHP53WEBSERVERTYPE = "iis4FastCGI")]]>
      </Custom>
      <Custom Action="fcgiconfigJSFastCGIrehook53SetExePath" After="fcgiconfigJSFastCGIrehook53SetExePathCmd">
        <![CDATA[(VersionNT = 502 AND ServicePackLevel >= 2) AND &iis4FastCGI = 2 AND (PHP53WEBSERVERTYPE = "iis4FastCGI")]]>
      </Custom>
      <Custom Action="fcgiconfigJSFastCGIrehook53SetPHPRCAndMAX_REQUESTSCmd" After="fcgiconfigJSFastCGIrehook53SetExePath">
        <![CDATA[(VersionNT = 502 AND ServicePackLevel >= 2) AND &iis4FastCGI = 2 AND (PHP53WEBSERVERTYPE = "iis4FastCGI")]]>
      </Custom>
      <Custom Action="fcgiconfigJSFastCGIrehook53SetPHPRCAndMAX_REQUESTS" After="fcgiconfigJSFastCGIrehook53SetPHPRCAndMAX_REQUESTSCmd">
        <![CDATA[(VersionNT = 502 AND ServicePackLevel >= 2) AND &iis4FastCGI = 2 AND (PHP53WEBSERVERTYPE = "iis4FastCGI")]]>
      </Custom>
      <Custom Action="fcgiconfigJSFastCGIremoveCmdXP" After="InstallInitialize">
        <![CDATA[((VersionNT = 501 AND ServicePackLevel >= 2) AND &iis4FastCGI = 2) AND (NOT PHP53WEBSERVERTYPE = "iis4FastCGI") AND (NOT PHP60WEBSERVERTYPE = "iis4FastCGI")]]>
      </Custom>
      <Custom Action="fcgiconfigJSFastCGIremoveXP" After="fcgiconfigJSFastCGIremoveCmdXP">
        <![CDATA[((VersionNT = 501 AND ServicePackLevel >= 2) AND &iis4FastCGI = 2) AND (NOT PHP53WEBSERVERTYPE = "iis4FastCGI") AND (NOT PHP60WEBSERVERTYPE = "iis4FastCGI")]]>
      </Custom>
      <Custom Action="fcgiconfigJSFastCGIrehook60SetExePathCmdXP" After="InstallInitialize">
        <![CDATA[(VersionNT = 501 AND ServicePackLevel >= 2) AND &iis4FastCGI = 2 AND (PHP60WEBSERVERTYPE = "iis4FastCGI")]]>
      </Custom>
      <Custom Action="fcgiconfigJSFastCGIrehook60SetExePathXP" After="fcgiconfigJSFastCGIrehook60SetExePathCmdXP">
        <![CDATA[(VersionNT = 501 AND ServicePackLevel >= 2) AND &iis4FastCGI = 2 AND (PHP60WEBSERVERTYPE = "iis4FastCGI")]]>
      </Custom>
      <Custom Action="fcgiconfigJSFastCGIrehook60SetPHPRCAndMAX_REQUESTSCmdXP" After="fcgiconfigJSFastCGIrehook60SetExePathXP">
        <![CDATA[(VersionNT = 501 AND ServicePackLevel >= 2) AND &iis4FastCGI = 2 AND (PHP60WEBSERVERTYPE = "iis4FastCGI")]]>
      </Custom>
      <Custom Action="fcgiconfigJSFastCGIrehook60SetPHPRCAndMAX_REQUESTSXP" After="fcgiconfigJSFastCGIrehook60SetPHPRCAndMAX_REQUESTSCmdXP">
        <![CDATA[(VersionNT = 501 AND ServicePackLevel >= 2) AND &iis4FastCGI = 2 AND (PHP60WEBSERVERTYPE = "iis4FastCGI")]]>
      </Custom>
      <Custom Action="fcgiconfigJSFastCGIrehook53SetExePathCmdXP" After="fcgiconfigJSFastCGIrehook60SetPHPRCAndMAX_REQUESTSXP">
        <![CDATA[(VersionNT = 501 AND ServicePackLevel >= 2) AND &iis4FastCGI = 2 AND (PHP53WEBSERVERTYPE = "iis4FastCGI")]]>
      </Custom>
      <Custom Action="fcgiconfigJSFastCGIrehook53SetExePathXP" After="fcgiconfigJSFastCGIrehook53SetExePathCmdXP">
        <![CDATA[(VersionNT = 501 AND ServicePackLevel >= 2) AND &iis4FastCGI = 2 AND (PHP53WEBSERVERTYPE = "iis4FastCGI")]]>
      </Custom>
      <Custom Action="fcgiconfigJSFastCGIrehook53SetPHPRCAndMAX_REQUESTSCmdXP" After="fcgiconfigJSFastCGIrehook53SetExePathXP">
        <![CDATA[(VersionNT = 501 AND ServicePackLevel >= 2) AND &iis4FastCGI = 2 AND (PHP53WEBSERVERTYPE = "iis4FastCGI")]]>
      </Custom>
      <Custom Action="fcgiconfigJSFastCGIrehook53SetPHPRCAndMAX_REQUESTSXP" After="fcgiconfigJSFastCGIrehook53SetPHPRCAndMAX_REQUESTSCmdXP">
        <![CDATA[(VersionNT = 501 AND ServicePackLevel >= 2) AND &iis4FastCGI = 2 AND (PHP53WEBSERVERTYPE = "iis4FastCGI")]]>
      </Custom>
      <Custom Action="configIIS4CustomActionDataValue" After="WriteRegistryValues">
        <![CDATA[VersionNT < 600 AND &iis4FastCGI = 3]]>
      </Custom>
      <Custom Action="configIIS4" After="configIIS4CustomActionDataValue">
        <![CDATA[VersionNT < 600 AND &iis4FastCGI = 3]]>
      </Custom>
      <Custom Action="unconfigIIS4" After="InstallInitialize">
        <![CDATA[VersionNT < 600 AND &iis4FastCGI = 2]]>
      </Custom>
      <RemoveExistingProducts After="InstallValidate" />
    </InstallExecuteSequence>
    
    <Property Id="WIXUI_INSTALLDIR" Value="INSTALLDIR"/>
    
    <UIRef Id="WixUI_FeatureTreePHP"/>
  </Product>
</Wix>
